(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{125:function(e,t,n){e.exports={App:"Messenger_App__2rWxQ"}},133:function(e,t,n){e.exports=n(202)},138:function(e,t,n){},173:function(e,t){},202:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7);n(138),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=n(31),o=n(43),i=n(89),l=n(50),u=n(123),m=n.n(u),d={socket:null,createConnection:function(){this.socket=m()("https://server-4-chat.herokuapp.com/")},subscribe:function(e,t,n){var a,r,c;null===(a=this.socket)||void 0===a||a.on("init-messages-published",e),null===(r=this.socket)||void 0===r||r.on("new-message-sent",t),null===(c=this.socket)||void 0===c||c.on("user-typing",n)},destroyConnection:function(){var e;null===(e=this.socket)||void 0===e||e.disconnect(),this.socket=null},sendName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-name-sent",e,(function(e){console.log(e),e&&alert(e)}))},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-message-sent",e,(function(e){e&&alert(e)}))},typeMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-typed")}},f={messages:[],typingUsers:[]},h=function(e){return{type:"CHAT/SET_MESSAGES",messages:e}},E=function(e){return{type:"CHAT/SET_NEW_MESSAGES",message:e}},g=function(e){return{type:"CHAT/SET_USER",user:e}},p=function(e){return{type:"CHAT/REMOVED_USER",user:e}},b=0,v=function(){return function(){d.destroyConnection()}},_=n(124),y=Object(o.c)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHAT/SET_MESSAGES":return Object(l.a)({},e,{messages:t.messages});case"CHAT/SET_NEW_MESSAGES":return Object(l.a)({},e,{messages:[].concat(Object(i.a)(e.messages),[t.message]),typingUsers:e.typingUsers.filter((function(e){return e.id!==t.message.user.id}))});case"CHAT/SET_USER":return Object(l.a)({},e,{typingUsers:[].concat(Object(i.a)(e.typingUsers.filter((function(e){return e.id!==t.user.id}))),[t.user])});case"CHAT/REMOVED_USER":return Object(l.a)({},e,{typingUsers:e.typingUsers.filter((function(e){return e.id!==t.user.id}))});default:return e}}}),O=Object(o.d)(y,Object(o.a)(_.a));window.store=O;var N=n(37),S=n(10),j=n(125),T=n.n(j),k=n(69),C=n.n(k),w=n(66),A=n.n(w),H=n(32),M=n(86),U=n.n(M),x=n(126),W=n.n(x),F=function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:U.a.chatName},r.a.createElement(W.a,{className:U.a.chatAvatar}),r.a.createElement("div",null,r.a.createElement("b",null,e.name,": "),e.message)),r.a.createElement("hr",null))},R=n(36),P=n.n(R),B=n(127),G=n.n(B),K=function(e){return r.a.createElement("div",{className:P.a.btn},r.a.createElement(G.a,{className:P.a.buttonText,size:"medium",variant:"outlined",color:"primary",disabled:e.disabled,onClick:e.onClickHandler},e.name))},V=function(e){var t=Object(s.c)((function(e){return e.chat.messages})),n=Object(s.c)((function(e){return e.chat.typingUsers})),c=Object(s.b)(),o=Object(a.useState)(""),i=Object(N.a)(o,2),l=i[0],u=i[1],m=Object(a.useState)(!0),f=Object(N.a)(m,2),h=f[0],E=f[1],g=Object(a.useState)(0),p=Object(N.a)(g,2),b=p[0],_=p[1];Object(a.useEffect)((function(){var e;h&&(null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[t,n,h]),Object(a.useEffect)((function(){return function(){c(v())}}),[c]);var y=Object(a.useRef)(null),O=function(){c(function(e){return function(){d.sendMessage(e)}}(l)),u("")},j=t.map((function(e){return r.a.createElement(F,{key:e.id,name:e.user.name,message:e.message})})),T=n.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("b",null,e.name,":")," ...")}));return"unknown"===e.name?r.a.createElement(S.a,{to:"/login"}):r.a.createElement("div",{className:C.a.main},r.a.createElement(H.b,{to:"/login"},r.a.createElement(K,{name:"Change name",onClickHandler:function(){c(v()),e.setTemporaryName("")}})),r.a.createElement("div",{className:C.a.chatWindow,onScroll:function(e){var t=e.currentTarget,n=t.scrollHeight-t.clientHeight;t.scrollTop>b&&Math.abs(n-t.scrollTop)<2?E(!0):E(!1),_(t.scrollTop)}},j,T,r.a.createElement("div",{ref:y})),r.a.createElement("div",{className:C.a.messageField},r.a.createElement(A.a,{id:"outlined-basic",label:"Enter your message...",value:l,onKeyPress:function(e){"Enter"===e.key&&O()},onChange:function(e){u(e.currentTarget.value),c((function(){d.typeMessage()}))}})),r.a.createElement(K,{name:"Send message",onClickHandler:O}))},I=function(e){var t=Object(s.b)(),n=Object(S.g)(),c=function(){var n;e.setName(e.temporaryName),t((n=e.temporaryName,function(){d.sendName(n)}))};return Object(a.useEffect)((function(){t((function(e){d.createConnection(),d.subscribe((function(t,n){e(h(t)),n("data from front")}),(function(t){e(E(t))}),(function(t){e(g(t)),clearTimeout(b),b=window.setTimeout((function(){e(p(t))}),5e3)}))}))}),[t]),r.a.createElement("div",{className:P.a.main},r.a.createElement("h1",{className:P.a.header},"Welcome to chat"),r.a.createElement("div",{className:P.a.nameField},r.a.createElement(A.a,{id:"outlined-basic",label:"Enter your name",onChange:function(t){e.setTemporaryName(t.currentTarget.value)},onKeyPress:function(t){"Enter"===t.key&&e.temporaryName.length>0&&(c(),n.push("/chat"))}})),r.a.createElement(H.b,{to:e.temporaryName.length<1?"/login":"/chat"},r.a.createElement(K,{name:"Enter to chat",disabled:e.temporaryName.length<1,onClickHandler:c})))},J=function(){var e=Object(a.useState)(""),t=Object(N.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)("unknown"),o=Object(N.a)(s,2),i=o[0],l=o[1];return r.a.createElement("div",{className:T.a.app},r.a.createElement(S.d,null,r.a.createElement(S.b,{exact:!0,path:"/",render:function(){return r.a.createElement(S.a,{to:"/login"})}}),r.a.createElement(S.b,{path:"/login",render:function(){return r.a.createElement(I,{setTemporaryName:c,temporaryName:n,setName:l,name:i})}}),r.a.createElement(S.b,{path:"/chat",render:function(){return r.a.createElement(V,{setTemporaryName:c,name:i})}})))};Object(c.render)(r.a.createElement(H.a,null,r.a.createElement(s.a,{store:O},r.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},36:function(e,t,n){e.exports={main:"LoginPage_main__3S-K3",nameField:"LoginPage_nameField__33iYm"}},69:function(e,t,n){e.exports={main:"Chat_main__1Fuvh",chatWindow:"Chat_chatWindow__1o-9T",messageField:"Chat_messageField__1LoVa",messageButton:"Chat_messageButton__2P5KJ",header:"Chat_header__3Y8xF"}},86:function(e,t,n){e.exports={chatName:"Message_chatName__1miE4",chatAvatar:"Message_chatAvatar__1_kI7"}}},[[133,1,2]]]);
//# sourceMappingURL=main.94eb601d.chunk.js.map